
# ğŸ“˜  User API ëª…ì„¸ì„œ
## Base URL
```
/user
```
---
## 1. \[GET] `/register` - íšŒì›ê°€ì… í˜ì´ì§€

* **ì„¤ëª…**: íšŒì›ê°€ì… í¼ì„ ë Œë”ë§í•©ë‹ˆë‹¤.
* **ì„¸ì…˜ í•„ìš” ì—¬ë¶€**: :x: (ë¡œê·¸ì¸ ìƒíƒœì¼ ê²½ìš° `/`ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸)
* **ì‘ë‹µ ë·°**: `register.ejs`
* **ë·° ì „ë‹¬ ë³€ìˆ˜**:

  ```js
  {
    title: "REGISTER USER",
    user: null,
    error: null
  }
  ```

---

## 2. \[POST] `/register` - íšŒì›ê°€ì… ìš”ì²­
* **ì„¤ëª…**: ì‚¬ìš©ì ì •ë³´ë¥¼ DBì— ì €ì¥í•©ë‹ˆë‹¤.
* **ìš”ì²­ ë°”ë””**:
  | í•„ë“œëª…      | íƒ€ì…     | í•„ìˆ˜ | ì„¤ëª…            |
  | -------- | ------ | -- | ------------- |
  | username | string | :white_check_mark:  | ì‚¬ìš©ì ì•„ì´ë””       |
  | password | string | :white_check_mark:  | ë¹„ë°€ë²ˆí˜¸          |
  | gender   | string | :x:  | ì„±ë³„ ("M", "F") |
  | birth    | string | :x:  | ìƒë…„ì›”ì¼          |
* **ë¡œì§**:
  * ì•„ì´ë”” ì¤‘ë³µ ì²´í¬
  * ë¹„ë°€ë²ˆí˜¸ í•´ì‹œ (`bcrypt.hash`)
  * ì‚¬ìš©ì ì €ì¥ í›„ í™ˆ(`/`)ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
* **ì—ëŸ¬ ì‹œ**: `register.ejs`ì— ì—ëŸ¬ ë©”ì‹œì§€ í¬í•¨ ë Œë”ë§
---

## 3. \[GET] `/login` - ë¡œê·¸ì¸ í˜ì´ì§€

* **ì„¤ëª…**: ë¡œê·¸ì¸ í¼ì„ ë Œë”ë§í•©ë‹ˆë‹¤.
* **ì„¸ì…˜ í•„ìš” ì—¬ë¶€**: :x: (ë¡œê·¸ì¸ ìƒíƒœì¼ ê²½ìš° `/`ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸)
* **ì‘ë‹µ ë·°**: `login.ejs`
* **ë·° ì „ë‹¬ ë³€ìˆ˜**:

  ```js
  {
    title: "LOGIN",
    user: null,
    error: null
  }
  ```

---

## 4. \[POST] `/login` - ë¡œê·¸ì¸ ìš”ì²­

* **ì„¤ëª…**: ì‚¬ìš©ì ì¸ì¦ ë° ì„¸ì…˜ ìƒì„±

* **ìš”ì²­ ë°”ë””**:
    
  | í•„ë“œëª…      | íƒ€ì…     | í•„ìˆ˜ | ì„¤ëª…      |
  | -------- | ------ | -- | ------- |
  | username | string | :white_check_mark:  | ì‚¬ìš©ì ì•„ì´ë”” |
  | password | string | :white_check_mark:  | ë¹„ë°€ë²ˆí˜¸    |

* **ë¡œì§**:

  * ì‚¬ìš©ì ì¡´ì¬ ì—¬ë¶€ í™•ì¸
  * `bcrypt.compare`ë¡œ ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
  * ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ì„¸ì…˜ì— ì €ì¥:

    ```js
    req.session.user = {
      username: findUser.username,
      isAdmin: findUser.role === "admin",
      cart: []
    }
    ```

* **ì„±ê³µ ì‹œ**: `/`ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

* **ì‹¤íŒ¨ ì‹œ**: `login.ejs`ì— ì—ëŸ¬ ë©”ì‹œì§€ í¬í•¨ ë Œë”ë§

---

## 5. \[GET] `/logout` - ë¡œê·¸ì•„ì›ƒ ìš”ì²­

* **ì„¤ëª…**: ì„¸ì…˜ì„ ì‚­ì œí•˜ê³  ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬

* **ì„¸ì…˜ í•„ìš” ì—¬ë¶€**: :white_check_mark: (`isAuthentication` ë¯¸ë“¤ì›¨ì–´ ì ìš©)

* **ë¡œì§**:

  * `req.session.destroy()`ë¡œ ì„¸ì…˜ ì œê±°
  * ì„±ê³µ ì‹œ `/`ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
  * ì‹¤íŒ¨ ì‹œ JSON ì—ëŸ¬ ë°˜í™˜

* **ì—ëŸ¬ ì‘ë‹µ ì˜ˆì‹œ**:

  ```json
  {
    "message": "ì„œë²„ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."
  }
  ```

---

## ê¸°íƒ€ ì •ë³´

* **ì¸ì¦ ë°©ì‹**: ì„¸ì…˜ ê¸°ë°˜ (`req.session.user`)
* **ë³´ì•ˆ ì²˜ë¦¬**: `bcryptjs` ì‚¬ìš©í•˜ì—¬ ë¹„ë°€ë²ˆí˜¸ í•´ì‹œ ë° ê²€ì¦
* **ì‚¬ìš© ë·° ì—”ì§„**: EJS (`res.render()` ì‚¬ìš©)
* **ê²€ì¦ ë¡œì§**:

  * íšŒì›ê°€ì… ì‹œ í•„ë“œ ëˆ„ë½ ë° ì¤‘ë³µ ì²´í¬
  * ë¡œê·¸ì¸ ì‹œ ì¡´ì¬ ì—¬ë¶€ ë° ë¹„ë°€ë²ˆí˜¸ í™•ì¸

---

---

# ğŸ“˜ Item API ëª…ì„¸ì„œ

## ğŸ“Œ Base URL

```
/products
```

---

## 1. \[GET] `/` - ìƒí’ˆ ëª©ë¡ ì¡°íšŒ

* **ì„¤ëª…**: ì „ì²´ ìƒí’ˆ ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
* **ì„¸ì…˜ í•„ìš” ì—¬ë¶€**: âŒ (ë¡œê·¸ì¸ ì—¬ë¶€ì™€ ë¬´ê´€)
* **ì‘ë‹µ ë·°**: `products.ejs`
* **ë·° ì „ë‹¬ ë³€ìˆ˜**:

  ```js
  {
    title: "ìƒí’ˆ ëª©ë¡",
    items, // ìƒí’ˆ ë¦¬ìŠ¤íŠ¸
    user: req.session.user
  }
  ```

---

## 2. \[GET] `/:id` - ìƒí’ˆ ìƒì„¸ ì¡°íšŒ

* **ì„¤ëª…**: íŠ¹ì • ìƒí’ˆì˜ ìƒì„¸ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

* **ì„¸ì…˜ í•„ìš” ì—¬ë¶€**: âŒ

* **URL íŒŒë¼ë¯¸í„°**:

  | íŒŒë¼ë¯¸í„° | íƒ€ì…     | í•„ìˆ˜ | ì„¤ëª…          |
  | ---- | ------ | -- | ----------- |
  | `id` | string | âœ…  | ìƒí’ˆ ObjectId |

* **ì‘ë‹µ ë·°**: `product-detail.ejs`

* **ì—ëŸ¬ ì²˜ë¦¬**: ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš° `404` ë°˜í™˜

* **ë·° ì „ë‹¬ ë³€ìˆ˜**:

  ```js
  {
    title: item.name,
    item,
    user: req.session.user
  }
  ```

---

## 3. \[GET] `/admin/new` - ìƒí’ˆ ë“±ë¡ í¼ (ê´€ë¦¬ì ì „ìš©)

* **ì„¤ëª…**: ìƒˆë¡œìš´ ìƒí’ˆ ë“±ë¡ í¼ í˜ì´ì§€
* **ì„¸ì…˜ í•„ìš” ì—¬ë¶€**: âœ…
* **ê¶Œí•œ í•„ìš”**: âœ… (ê´€ë¦¬ì)
* **ë¯¸ë“¤ì›¨ì–´**: `hasAdminRole`
* **ì‘ë‹µ ë·°**: `product-form.ejs`
* **ë·° ì „ë‹¬ ë³€ìˆ˜**:

  ```js
  {
    title: "ìƒí’ˆ ë“±ë¡",
    item: null,
    user: req.session.user
  }
  ```

---

## 4. \[POST] `/admin/new` - ìƒí’ˆ ë“±ë¡ ìš”ì²­ (ê´€ë¦¬ì ì „ìš©)

* **ì„¤ëª…**: ì‹ ê·œ ìƒí’ˆì„ ìƒì„±í•©ë‹ˆë‹¤.

* **ì„¸ì…˜ í•„ìš” ì—¬ë¶€**: âœ…

* **ê¶Œí•œ í•„ìš”**: âœ… (ê´€ë¦¬ì)

* **ìš”ì²­ ë°”ë””**:

  | í•„ë“œëª…           | íƒ€ì…     | í•„ìˆ˜ | ì„¤ëª…      |
  | ------------- | ------ | -- | ------- |
  | `name`        | string | âœ…  | ìƒí’ˆëª…     |
  | `price`       | number | âœ…  | ê°€ê²©      |
  | `image`       | string | âŒ  | ì´ë¯¸ì§€ URL |
  | `description` | string | âŒ  | ìƒí’ˆ ì„¤ëª…   |
  | `stock`       | number | âŒ  | ì¬ê³  ìˆ˜ëŸ‰   |
  | `category`    | string | âŒ  | ì¹´í…Œê³ ë¦¬    |

* **ì„±ê³µ ì‹œ**: `/products`ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

---

## 5. \[GET] `/admin/edit/:id` - ìƒí’ˆ ìˆ˜ì • í¼ (ê´€ë¦¬ì ì „ìš©)

* **ì„¤ëª…**: íŠ¹ì • ìƒí’ˆì˜ ìˆ˜ì • í¼ í˜ì´ì§€ ë Œë”ë§

* **ì„¸ì…˜ í•„ìš” ì—¬ë¶€**: âœ…

* **ê¶Œí•œ í•„ìš”**: âœ… (ê´€ë¦¬ì)

* **URL íŒŒë¼ë¯¸í„°**:

  | íŒŒë¼ë¯¸í„° | íƒ€ì…     | í•„ìˆ˜ | ì„¤ëª…          |
  | ---- | ------ | -- | ----------- |
  | `id` | string | âœ…  | ìƒí’ˆ ObjectId |

* **ì‘ë‹µ ë·°**: `product-form.ejs`

* **ë·° ì „ë‹¬ ë³€ìˆ˜**:

  ```js
  {
    title: "ìƒí’ˆ ìˆ˜ì •",
    item,
    user: req.session.user
  }
  ```

* **ì—ëŸ¬ ì²˜ë¦¬**: ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš° `404` ë°˜í™˜

---

## 6. \[POST] `/admin/edit/:id` - ìƒí’ˆ ìˆ˜ì • ìš”ì²­ (ê´€ë¦¬ì ì „ìš©)

* **ì„¤ëª…**: ìƒí’ˆ ì •ë³´ë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤.

* **ì„¸ì…˜ í•„ìš” ì—¬ë¶€**: âœ…

* **ê¶Œí•œ í•„ìš”**: âœ… (ê´€ë¦¬ì)

* **URL íŒŒë¼ë¯¸í„°**:

  | íŒŒë¼ë¯¸í„° | íƒ€ì…     | í•„ìˆ˜ | ì„¤ëª…          |
  | ---- | ------ | -- | ----------- |
  | `id` | string | âœ…  | ìƒí’ˆ ObjectId |

* **ìš”ì²­ ë°”ë””**:
  ë™ì¼í•œ í•„ë“œ êµ¬ì¡° (`name`, `price`, `image`, `description`, `stock`, `category`)

* **ì„±ê³µ ì‹œ**: `/products`ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

---

## 7. \[POST] `/admin/delete/:id` - ìƒí’ˆ ì‚­ì œ ìš”ì²­ (ê´€ë¦¬ì ì „ìš©)

* **ì„¤ëª…**: ìƒí’ˆì„ ì‚­ì œí•©ë‹ˆë‹¤.

* **ì„¸ì…˜ í•„ìš” ì—¬ë¶€**: âœ…

* **ê¶Œí•œ í•„ìš”**: âœ… (ê´€ë¦¬ì)

* **URL íŒŒë¼ë¯¸í„°**:

  | íŒŒë¼ë¯¸í„° | íƒ€ì…     | í•„ìˆ˜ | ì„¤ëª…          |
  | ---- | ------ | -- | ----------- |
  | `id` | string | âœ…  | ìƒí’ˆ ObjectId |

* **ì„±ê³µ ì‹œ**: `/products`ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

---

## âœ… ê¸°íƒ€ ì‚¬í•­

* **ì¸ì¦/ê¶Œí•œ ë¯¸ë“¤ì›¨ì–´**:

  * `isAuthentication`: ë¡œê·¸ì¸ ì—¬ë¶€ í™•ì¸
  * `hasAdminRole`: ê´€ë¦¬ì ê¶Œí•œ ì—¬ë¶€ í™•ì¸
* **ì‚¬ìš© ë·° ì—”ì§„**: `EJS`
* **ì˜¤ë¥˜ ì²˜ë¦¬**:

  * `findById` ì‹¤íŒ¨ ì‹œ 404 ë°˜í™˜ (`ìƒí’ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)
* **ë¼ìš°íŒ… êµ¬ì¡°**: ê´€ë¦¬ì ì „ìš© ê²½ë¡œëŠ” `/admin/...` í˜•íƒœë¡œ êµ¬ë¶„

---
---

# ğŸ›’ Cart API ëª…ì„¸ì„œ

## ğŸ“Œ Base URL

```
/cart
```

---

### 1. \[GET] `/` - ì¥ë°”êµ¬ë‹ˆ ì¡°íšŒ

* **ì„¤ëª…**: ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ì¥ë°”êµ¬ë‹ˆ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
* **ì¸ì¦ í•„ìš”**: âœ… (`isAuthentication`)
* **ë™ì‘**:

  * `User.cart`ì˜ `item` í•„ë“œë¥¼ `populate()`ë¡œ ì±„ì›€
  * ì¥ë°”êµ¬ë‹ˆ í•­ëª©ì˜ ìˆ˜ëŸ‰ê³¼ ì´ ê¸ˆì•¡ ê³„ì‚°
* **ì‘ë‹µ ë·°**: `cart.ejs`
* **ë·° ì „ë‹¬ ë³€ìˆ˜**:

  ```js
  {
    title: "ì¥ë°”êµ¬ë‹ˆ",
    cart: [...],          // í•­ëª© ëª©ë¡
    totalPrice: number,
    user: req.session.user
  }
  ```

---

### 2. \[POST] `/add` - ì¥ë°”êµ¬ë‹ˆì— ìƒí’ˆ ì¶”ê°€

* **ì„¤ëª…**: íŠ¹ì • ìƒí’ˆì„ ì¥ë°”êµ¬ë‹ˆì— 1ê°œ ì¶”ê°€í•˜ê³ , ì¬ê³ ë¥¼ 1ê°œ ê°ì†Œì‹œí‚µë‹ˆë‹¤.

* **ì¸ì¦ í•„ìš”**: âœ…

* **ìš”ì²­ ë°”ë””**:

  | í•„ë“œëª…       | íƒ€ì…     | í•„ìˆ˜ | ì„¤ëª…          |
  | --------- | ------ | -- | ----------- |
  | productId | string | âœ…  | ìƒí’ˆ ObjectId |

* **ê²€ì¦ ë° ì²˜ë¦¬**:

  * ìƒí’ˆ ì¡´ì¬ ì—¬ë¶€ ë° ì¬ê³  í™•ì¸
  * ì¥ë°”êµ¬ë‹ˆì— ì´ë¯¸ ìˆìœ¼ë©´ ìˆ˜ëŸ‰ ì¦ê°€
  * ì—†ìœ¼ë©´ ìƒˆ í•­ëª© ì¶”ê°€
  * ì¬ê³  ê°ì†Œ â†’ ì €ì¥ í›„ `/cart`ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

---

### 3. \[POST] `/remove` - ì¥ë°”êµ¬ë‹ˆì—ì„œ ìƒí’ˆ ì œê±°

* **ì„¤ëª…**: í•´ë‹¹ ìƒí’ˆì„ ì¥ë°”êµ¬ë‹ˆì—ì„œ ì œê±°í•˜ê³ , ì¬ê³ ë¥¼ ë³µì›í•©ë‹ˆë‹¤.

* **ì¸ì¦ í•„ìš”**: âœ…

* **ìš”ì²­ ë°”ë””**:

  | í•„ë“œëª…       | íƒ€ì…     | í•„ìˆ˜ | ì„¤ëª…          |
  | --------- | ------ | -- | ----------- |
  | productId | string | âœ…  | ìƒí’ˆ ObjectId |

* **ì²˜ë¦¬ ë‚´ìš©**:

  * `User.cart`ì—ì„œ í•´ë‹¹ í•­ëª© ì œê±°
  * ì¬ê³  ìˆ˜ëŸ‰ ë³µì›
  * `/cart`ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

---

# ğŸ› ï¸ Admin API ëª…ì„¸ì„œ

## ğŸ“Œ Base URL

```
/admin
```

> ê´€ë¦¬ì ì¸ì¦ ë¯¸ë“¤ì›¨ì–´ `hasAdminRole` ì „ì²´ ì ìš©ë¨

---

## ğŸ”¹ View ê¸°ë°˜

### 1. \[GET] `/` - ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ

* **ì„¤ëª…**: ê´€ë¦¬ì í™ˆ í™”ë©´ ë Œë”ë§ (ëª¨ë“  ì‚¬ìš©ì ë° ìƒí’ˆ ëª©ë¡ í¬í•¨)
* **ì‘ë‹µ ë·°**: `admin.ejs`
* **ë·° ì „ë‹¬ ë³€ìˆ˜**:

  ```js
  {
    title: "WELCOME ADMIN PAGE",
    user: req.session.user,
    users: [...],
    products: [...],
    error: null
  }
  ```

---

## ğŸ”¹ RESTful ì‚¬ìš©ì ê´€ë¦¬

### \[GET] `/users/` - ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ

### \[GET] `/users/:id` - ë‹¨ì¼ ì‚¬ìš©ì ì¡°íšŒ

### \[PATCH] `/users/:id` - ì‚¬ìš©ì ì¼ë¶€ ì •ë³´ ìˆ˜ì • (`birth`, `gender`)

### \[DELETE] `/users/:id` - ì‚¬ìš©ì ì‚­ì œ

* **í˜•ì‹**: JSON API
* **ì‘ë‹µ ì˜ˆì‹œ**:

  ```json
  {
    "username": "user1",
    "createdAt": "...",
    "updatedAt": "...",
    "cart": [...]
  }
  ```

---

## ğŸ”¹ API ê¸°ë°˜ ì‚¬ìš©ì ê´€ë¦¬

### \[GET] `/api/users`

* ì„¤ëª…: ëª¨ë“  ì‚¬ìš©ì JSON ì¡°íšŒ

### \[GET] `/api/users/:id`

* ì„¤ëª…: ì‚¬ìš©ì ìƒì„¸ ì¡°íšŒ

### \[PATCH] `/api/users/:id`

* ì„¤ëª…: ì‚¬ìš©ì ì •ë³´ ì „ì²´ ìˆ˜ì •
* ë°”ë””: ì‚¬ìš©ì ì „ì²´ í•„ë“œ (`username`, `gender`, `birth` ë“±)

### \[DELETE] `/api/users/:id`

* ì„¤ëª…: ì‚¬ìš©ì ì‚­ì œ
* ì‘ë‹µ: `{ message: "ì‚­ì œ ì™„ë£Œ" }`

---

## ğŸ”¹ API ê¸°ë°˜ ìƒí’ˆ ê´€ë¦¬

### \[GET] `/api/products`

* ì„¤ëª…: ì „ì²´ ìƒí’ˆ ì¡°íšŒ

### \[GET] `/api/products/:id`

* ì„¤ëª…: ìƒí’ˆ ìƒì„¸ ì¡°íšŒ

### \[PATCH] `/api/products/:id`

* ì„¤ëª…: ìƒí’ˆ ì •ë³´ ìˆ˜ì •
* ë°”ë””: ìƒí’ˆ í•„ë“œ (`name`, `price`, `image`, `stock`, `description`, `category` ë“±)

### \[DELETE] `/api/products/:id`

* ì„¤ëª…: ìƒí’ˆ ì‚­ì œ
* ì‘ë‹µ: `{ message: "ì‚­ì œ ì™„ë£Œ" }`

---

## âœ… ê³µí†µ ì²˜ë¦¬

* **ì—ëŸ¬ ì²˜ë¦¬**: ëª¨ë“  APIì—ì„œ `500` ìƒíƒœ ì‹œ `message: "ì„œë²„ ì˜¤ë¥˜"` ë°˜í™˜
* **ë¯¸ë“¤ì›¨ì–´**:

  * `hasAdminRole`: ê´€ë¦¬ì ê¶Œí•œ í™•ì¸
  * `isAuthentication`: ë¡œê·¸ì¸ ì—¬ë¶€ í™•ì¸ (ì¥ë°”êµ¬ë‹ˆ)

---
